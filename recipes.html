<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recipes</title>
    <style>
      :root {
        --bg: #f7f3ee;
        --card: #ffffff;
        --ink: #2a2a2a;
        --muted: #6f6f6f;
        --accent: #8b5e3c;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Georgia", "Times New Roman", serif;
        color: var(--ink);
        background: linear-gradient(180deg, #f7f3ee 0%, #efe6dc 100%);
      }

      header {
        padding: 32px 24px 12px;
        text-align: center;
      }

      header h1 {
        margin: 0 0 8px;
        font-size: 2.4rem;
        letter-spacing: 0.5px;
      }

      header p {
        margin: 0;
        color: var(--muted);
        font-size: 1rem;
      }

      main {
        max-width: 1000px;
        margin: 0 auto;
        padding: 24px;
      }

      .recipe-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 20px;
      }

      .recipe-card {
        background: var(--card);
        border-radius: 14px;
        padding: 20px;
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
        border: 1px solid rgba(0, 0, 0, 0.05);
        display: flex;
        flex-direction: column;
        gap: 14px;
      }

      .recipe-title {
        font-size: 1.3rem;
        margin: 0;
      }

      .origin {
        color: var(--muted);
        font-size: 0.95rem;
      }

      .section-title {
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 1.2px;
        color: var(--accent);
        margin: 0 0 6px;
      }

      ul,
      ol {
        margin: 0;
        padding-left: 18px;
        color: var(--ink);
      }

      .history {
        font-size: 0.9rem;
        color: var(--muted);
        line-height: 1.5;
      }

      footer {
        text-align: center;
        padding: 24px;
        color: var(--muted);
        font-size: 0.85rem;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Forgotten Flavors</h1>
      <p>Recipes cataloged with origin, ingredients, steps, and history.</p>
    </header>

    <main>
      <section class="recipe-grid" id="recipeGrid"></section>
    </main>

    <footer>Sample layout mapping recipe model fields to UI.</footer>

    <script>
      const grid = document.getElementById("recipeGrid");

      const formatOrigin = (origin) => {
        const parts = [origin.region, origin.country, origin.city].filter(Boolean);
        const location = parts.join(", ");
        return location ? `Origin: ${location}` : "Origin: Unknown";
      };

      const formatIngredient = (item) => {
        const qty = item.quantity !== undefined ? `${item.quantity}` : "";
        const unit = item.unit ? ` ${item.unit}` : "";
        const prep = item.preparation ? ` (${item.preparation})` : "";
        const optional = item.optional ? " (optional)" : "";
        return `${item.name} â€” ${qty}${unit}${prep}${optional}`.trim();
      };

      const renderRecipe = (recipe) => {
        const card = document.createElement("article");
        card.className = "recipe-card";

        const title = document.createElement("h2");
        title.className = "recipe-title";
        title.textContent = recipe.name;

        const origin = document.createElement("div");
        origin.className = "origin";
        origin.textContent = formatOrigin(recipe.origin || {});

        const ingredientsSection = document.createElement("div");
        ingredientsSection.innerHTML = "<h3 class='section-title'>Ingredients</h3>";
        const ingredientsList = document.createElement("ul");
        (recipe.ingredients || []).forEach((item) => {
          const li = document.createElement("li");
          li.textContent = formatIngredient(item);
          ingredientsList.appendChild(li);
        });
        ingredientsSection.appendChild(ingredientsList);

        const stepsSection = document.createElement("div");
        stepsSection.innerHTML = "<h3 class='section-title'>Steps</h3>";
        const stepsList = document.createElement("ol");
        (recipe.steps || [])
          .sort((a, b) => a.order - b.order)
          .forEach((step) => {
            const li = document.createElement("li");
            li.textContent = step.instruction;
            stepsList.appendChild(li);
          });
        stepsSection.appendChild(stepsList);

        const historySection = document.createElement("div");
        historySection.innerHTML = "<h3 class='section-title'>History</h3>";
        const history = document.createElement("p");
        history.className = "history";
        history.textContent = recipe.history?.summary || "No history available.";
        historySection.appendChild(history);

        card.appendChild(title);
        card.appendChild(origin);
        card.appendChild(ingredientsSection);
        card.appendChild(stepsSection);
        card.appendChild(historySection);

        return card;
      };

      const loadRecipes = async () => {
        try {
          const response = await fetch("/api/recipes");
          if (!response.ok) {
            throw new Error("Failed to load recipes.");
          }
          const data = await response.json();
          grid.innerHTML = "";
          data.forEach((recipe) => grid.appendChild(renderRecipe(recipe)));
        } catch (error) {
          grid.innerHTML = "<p>Could not load recipes. Please try again.</p>";
        }
      };

      loadRecipes();
    </script>
  </body>
</html>
